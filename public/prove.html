<!doctype html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>Prove Bot</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
      body { font:14px system-ui; padding:16px; background:#f9f9f9; }
      button { padding:10px 16px; border-radius:8px; border:none; background:#0088cc; color:white; font-weight:600; cursor:pointer; margin-right:8px; }
      button:hover { background:#0077bb; }
      pre { margin-top:16px; padding:12px; background:#fff; border:1px solid #ddd; border-radius:6px; white-space:pre-wrap; word-break:break-word; }
    </style>
  </head>
  <body>
    <button id="btnEcho">Debug Echo</button>
    <button id="btnProve">Prove Bot</button>
    <pre id="out"></pre>

    <script>
      const out = document.getElementById('out');
      function log(x){ out.textContent = typeof x==='string'? x : JSON.stringify(x,null,2); }
      Telegram.WebApp.ready();

      async function callApi(endpoint) {
        try {
          const initData = Telegram?.WebApp?.initData || "";
          log({ endpoint, initDataLen: initData.length, startsWith: initData.slice(0,40) });
          const r = await fetch(endpoint, {
            method: 'POST',
            headers: { 'content-type': 'application/json' },
            body: JSON.stringify({ initData })
          });
          const j = await r.json();
          log(j);
        } catch (e) { log(String(e)); }
      }

      document.getElementById('btnEcho').onclick = () => callApi('/api/debug-echo');
      document.getElementById('btnProve').onclick = () => callApi('/api/debug-prove-bot');
    </script>
  </body>
</html>
